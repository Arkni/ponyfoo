- longDate = 'dddd Do, MMMM YYYY [at] HH:mm'
- when = moment(article.publication)
- modified = moment(article.updated)
- commentCount = article.commentCount

aside.de-sidebar
  section.ca-container
    script#_carbonads_js(src='//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=ponyfoocom', async)
    div.ca-help-me.uv-hidden
      span='Please consider disabling your ad blocker on Pony Foo. You can also support me directly through '
      a(href='https://patreon.com/bevacqua') Patreon
      span .

  form#search.ly-section.de-search(action='/articles/search', method='get', name='search')
    input.de-input.sr-input(placeholder='e.g JavaScript', name='terms', value=query && query.replace(/"/g,''))

    span.bt-label.de-button(aria-label='Pro Tip: use "[js]" to search for article tags!')
      button.gg-container.bt-button.bt-pink.sr-button(type='submit')
        span.bt-text Search
        include ../partials/button-background

  section.dm-container.ly-section
    header
      h3.dm-title Trivia Box

    div
      if article.status === 'draft'
        label.dm-label Draft
      if article.status === 'publish'
        label.dm-label Slated for Publication
        span.dm-value
          span=' '
          time(aria-label='Publishing ' + when.format(longDate), datetime=when.format())=when.fromNow()
      if article.status === 'published'
        label.dm-label Published
        span.dm-value
          span=' '
          time(aria-label='Published ' + modified.format(longDate), datetime=modified.format())=modified.fromNow()

    div
      label.dm-label Length
      span.dm-value
        span=' '
        span=moment.duration(article.readingTime, 'seconds').humanize().replace(/s$/, '')
        span=' read'

    div
      label.dm-label Comments
      span.dm-value
        span=' '
        a(href='#comments')=commentCount || 'None yet'

    div
      label.dm-label.dm-label-block Tagged
      span.dm-value.dm-value-block
        include ../partials/tags

    if article.related.length
      div
        label.dm-label.dm-label-block Similar Articles
        ul.dm-value.dm-value-block
          each related in article.related
            li.dm-related-item
              a(href='/articles/' + related.slug, aria-label='Read the article!')=related.title

  form.ly-section.ss-container.de-subscribe(action='/api/subscribers', method='post', name='subscribe')
    div.ss-label
      strong Subscribe
      span=' to our mailing list and be the first to know when new articles come out!'
    div.ss-label.ss-unsubscribe
      sub One-click unsubscribe, anytime.

    noscript
      input.uv-verify(name='verify', value='Promise not to be a bot? Clear this field!', placeholder='This field is only for tricksters...')

    input.ss-source(type='hidden', name='source', value='sidebar')
    input.de-input.ss-input(placeholder='you@provider.io', name='subscriber')

    span.bt-label.de-button(aria-label='As easy as clicking this button and confirming via email!')
      button.gg-container.bt-button.bt-pink.ss-button(type='submit')
        span.bt-text Subscribe
        include ../partials/button-background

  section.ly-section.de-bio.md-markdown!=bioHtml

  if popularArticles.length
    section.ly-section
      h3 Greatest Hits
      ul.de-popular
        each article in popularArticles
          li
            a(
              href='/articles/' + article.slug,
              aria-label=moment(article.publication).format('(YYYY)') + ' Tagged: ' + article.tags.join(', ')
            )=article.title
